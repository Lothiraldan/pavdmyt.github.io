<!DOCTYPE html><html lang="en-us"><head><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="description" content="Jekyll tasks optimization, simplification and automation. Build and serve Jekyll site. Clean Jekyll site. Jekyll doctor. List Jekyll site posts. Ping Jekyll sitemap updates. Creating new post. Preview Jekyll site in default browser."><meta name="author" content="Pavel Dmytrenko"><meta name="keywords" content="Python, Programming, Math, Algorithms, Jekyll, Static sites, Blogging"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>Blog | Simplifying and extending Jekyll CLI capabilities using Jtasks &middot; Stochastic Stuff by Pavel Dmytrenko</title><link rel="stylesheet" href="/public/css/poole.css"><link rel="stylesheet" href="/public/css/lanyon.css"><link rel="stylesheet" href="/public/css/ir-black.css"><script src="/public/js/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400"><link href="/atom.xml" rel="alternate" title="Atom" type="application/atom+xml"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-68140687-1', 'auto');
  ga('send', 'pageview');</script></head><body><input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><div class="sidebar" id="sidebar"><div class="sidebar-item"><p>A place for Python, Math and maybe Science Fiction.</p></div><nav class="sidebar-nav"><a class="sidebar-nav-item" href="/"><svg class="icon-portal"></svg> Home</a> <a class="sidebar-nav-item" href="/about/"><svg class="icon-about"></svg> About</a> <a class="sidebar-nav-item" href="/archive/"><svg class="icon-archive"></svg> Archive</a> <a class="sidebar-nav-item" href="/tags/"><svg class="icon-tags"></svg> Tags</a></nav><div class="sidebar-item"><p>&copy; 2016. All rights reserved.</p></div></div><div class="wrap"><div class="masthead"><div class="container"><h3 class="masthead-title"><a href="/" rel="bookmark" title="Home" class="masthead-link">Stochastic Stuff</a> by <a href="/about/" rel="bookmark" title="About" class="masthead-link">Pavel Dmytrenko</a> <small></small> <a class="soc-icons" rel="bookmark" title="Atom feed" href="/atom.xml"><svg class="icon-rss"></svg></a> <a class="soc-icons" rel="external" title="@pavdmyt Twitter account" href="https://twitter.com/pavdmyt"><svg class="icon-bird"></svg></a> <a class="soc-icons" rel="external" title="My GitHub repos" href="https://github.com/pavdmyt"><svg class="icon-git"></svg></a></h3></div></div><div class="container content"><ul class="tags"><li><a href="/tags#jekyll" class="tag">jekyll</a></li><li><a href="/tags#blogging" class="tag">blogging</a></li><li><a href="/tags#python" class="tag">python</a></li></ul><div class="post"><h1 class="post-title">Simplifying and extending Jekyll CLI capabilities using Jtasks</h1><span class="post-date"><svg class="icon-calendar"></svg> 20 February 2016</span><p>When I started using Jekyll, serving a site was as simple as short <code>jekyll serve</code> command. After creating a few first posts I discovered <a href="http://jekyllrb.com/docs/drafts/">drafts</a> feature. Now serving a site command became <code>jekyll serve --drafts</code>. Then Jekyll 3 was released and I have figured out that <a href="https://pages.github.com/">GitHub Pages</a> not necessarily switched to building hosted sites using the latest Jekyll release (<em>now GitHub Pages supports Jekyll 3, but migration took a few months</em>). Iâ€™m hosting <a href="https://github.com/pavdmyt/pavdmyt.github.io">this blog at GitHub</a>, so I had to keep my development environment in align with environment used by GitHub. Otherwise, developing with Jekyll 3 locally and then pushing results to GitHubâ€™s build server on Jekyll 2.4 may result in <a href="http://jekyllrb.com/docs/upgrading/2-to-3/">compatibility issues</a>. Luckily, keeping environment in alignment with GitHub can be easily achieved by <a href="https://help.github.com/articles/using-jekyll-with-pages/">using <code>gh-pages</code></a> gem.</p><p>This adds another layer of complexity. Now we need a <a href="http://bundler.io/">Bundler</a> to manage our environment. Commands inside a given <em>bundle</em> are launched using <code>bundle exec</code>. Now to serve a site including drafts, we have to type:</p><div class="highlight"><pre><code class="language-bash" data-lang="bash">$ bundle exec jekyll serve --drafts</code></pre></div><p>Not so convenient as in the beginning, huh?</p><p>In my <a href="/jekyll-dev-env-via-vagrant-and-puphpet">previous post</a> I have showed set up steps and discussed advantages of using <a href="https://www.vagrantup.com/">Vagrant</a> to build development environment for Jekyll projects. In spite of advantages, Vagrant brings another layer of complexity. For me this resulted in creation of the <code>Makefile</code> with the shortcuts for something like:</p><div class="highlight"><pre><code class="language-bash" data-lang="bash">$ bundle exec jekyll serve --host 0.0.0.0 --drafts --force-polling</code></pre></div><p>This includes various combinations for different jekyll subcommands and options (<em>basic usage is</em>: <code>jekyll &lt;subcommand&gt; [options]</code>). Obviously <code>make</code> is not the best way to manage this. It is very easy to get confused with different <code>make</code> tasks.</p><p>So, I decided to write my own tool which will wrap common Jekyll commands, providing corresponding set of tasks easily modifiable via both long and short CLI flags. And if Iâ€™m writing my own tool, of course it will contain some <em>advanced</em> features ðŸ˜‰.</p><h2 id="meet-jtasks">Meet Jtasks</h2><p><a href="https://github.com/pavdmyt/jtasks">Jtasks</a> (Jekyll tasks) is a collection of configurable <a href="http://www.pyinvoke.org/">Invoke</a> tasks that provide simple, but powerful, interface to run both common and <em>advanced</em> routines in your Jekyll projects.</p><p>With <strong>jtasks</strong> you can:</p><div class="highlight"><pre><code class="language-bash" data-lang="bash">$ inv --list
Available tasks:

  build     Build the site.
  clean     Clean the site.
  doctor    Search site and print specific deprecation warnings.
  list      List all posts.
  notify    Notify various services about sitemap update.
  post      Create a new post.
  preview   Launches default browser for previewing generated site.
  serve     Serve the site locally.</code></pre></div><p>Basically itâ€™s a collection of configurable tasks which are launched via <code>inv</code> or <code>invoke</code> command:</p><div class="highlight"><pre><code class="language-bash" data-lang="bash"># using jtasks:
$ invoke serve -bd

# common way:
$ bundle exec jekyll serve -d ./dist/ --host 0.0.0.0 --port 5000 --drafts</code></pre></div><p><code>--destination</code>, <code>--host</code> and <code>--port</code> are configured as a global variables at the <em>settings</em> part of the script:</p><div class="highlight"><pre><code class="language-python" data-lang="python"># === Settings ===

# Project directories
_site_dest = &quot;./dist/&quot;        # Dir where Jekyll will generate site
_posts_dest = &quot;./_posts/&quot;     # Dir with posts
_drafts_dest = &quot;./_drafts/&quot;   # Dir with drafts

# Global options
_hostname = &#39;0.0.0.0&#39;         # Listen given hostname
_port = &#39;5000&#39;                # Listen given port
_bundle_exec = False          # Run commands with Bundler
_fpolling = False             # Force watch to use polling
_incremental = False          # Enable incremental build (Jekyll 3)

# Post settings
_post_ext = &#39;.md&#39;             # Post files extension

# Notification settings (your sitemap location)
_sitemap_url = &#39;http://www.example.com/sitemap.xml&#39;</code></pre></div><p>This allows flexible setup of <strong>jtasks</strong> on per-project basis eliminating the need to explicitly specify your Jekyll projectâ€™s constant values every time.</p><p><strong>Jtasks</strong> also contains help documentation for each task:</p><div class="highlight"><pre><code class="language-bash" data-lang="bash">$ inv --help serve
Docstring:
  Serve the site locally.

  jekyll serve [options]

Options:
  -b, --bundle-exec         Run Jekyll development server via Bundler.
  -d, --drafts              Process and render draft posts.
  -f, --force-polling       Force watch to use polling.
  -i, --incremental-build   Rebuild only posts and pages that have changed.</code></pre></div><p>For more details and usage examples check <a href="https://github.com/pavdmyt/jtasks">projectâ€™s page</a> at GitHub.</p><br><p style="font-size:90%">Previous post: <a href="/jekyll-dev-env-via-vagrant-and-puphpet">Jekyll development environment via Vagrant and PuPHPet</a></p><p style="font-size:90%">Next post: <a href="/better-postgresql-cli-experience-with-psqlrc-tweaks">A better PostgreSQL CLI experience with few psqlrc tweaks</a></p></div><div id="disqus_thread"></div><script type="text/javascript">/* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'pavdmyt';
    var disqus_identifier = "/simplifying-extending-jekyll-cli-with-jtasks";  // Fixes issue with different disqus comments on page / and /index.html

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><div class="footer"><p class="copyright">&copy; Copyright 2016 by Pavel Dmytrenko.</p></div></div></div><label for="sidebar-checkbox" class="sidebar-toggle"></label><script>(function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);</script></body></html>